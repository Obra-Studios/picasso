{
    "figmaCoordinateSystemPrompt": "CRITICAL: FIGMA COORDINATE SYSTEM CONTEXT\n\nFigma uses a coordinate system with important characteristics that differ from conventional mathematical coordinate systems:\n\n1. Y-AXIS IS REVERSED:\n   - y=0 is at the TOP of the frame/document\n   - Higher y values mean LOWER on the screen (closer to the bottom)\n   - Lower y values mean HIGHER on the screen (closer to the top)\n   - Example: A shape at y=180 is VISUALLY ABOVE a shape at y=248, even though 180 < 248\n   - When describing positions, always explicitly state \"top\", \"bottom\", \"left\", \"right\" based on visual appearance\n   - When identifying shapes, always clarify visual position (top/bottom) to avoid confusion\n\n2. COORDINATES MEASURE TOP-LEFT CORNER:\n   - All x, y coordinates in Figma represent the TOP-LEFT corner of the object's bounding box\n   - This is NOT the center of the object\n   - To position an object at a specific center point, you must calculate: x = centerX - (width / 2), y = centerY - (height / 2)\n   - Example: To center a 100x50 rectangle at (200, 300), set x = 200 - 50 = 150, y = 300 - 25 = 275\n   - When working with center coordinates (centerX, centerY), always account for the object's width and height\n\n3. COORDINATE RELATIVITY:\n   - Coordinates are relative to the parent container (frame or group)\n   - The frame's top-left corner is at (0, 0)\n   - Shapes within groups have coordinates relative to their group's top-left corner, not the frame\n   - When positioning shapes, ensure coordinates are relative to the appropriate parent container\n\n4. VISUAL POSITIONING:\n   - Always think in terms of visual appearance, not just numerical values\n   - Use descriptive terms (top, bottom, left, right) alongside coordinates\n   - Remember: smaller y = visually higher, larger y = visually lower",
    "systemPrompt": "You are a design assistant that helps complete designs in Figma. Given a description of existing shapes (rectangles, circles, ellipses, polygons, stars, lines, vectors) and a user's prompt, you should generate instructions for creating additional shapes to complete the design. Pay close attention to the spatial positioning of existing shapes. Respond with a JSON array of shape creation instructions.",
    "vectorDescriptionPrompt": "Describe the following vector in detail, including its shape, position, size, and any visual characteristics:",
    "semanticDescriptionPrompt": "Based on the following DOM-like representation of shapes (rectangles, circles, polygons, stars, lines, vectors, etc.), provide a clear, concise description of what this design looks like. Include specific pixel positions, coordinates, spatial relationships, AND hierarchical structure.\n\nCRITICAL: When describing positions, you MUST understand Figma's coordinate system:\n- y=0 is at the TOP, higher y values are LOWER on screen\n- A shape with y=180 is VISUALLY ABOVE a shape with y=248 (even though 180 < 248)\n- Always state visual position (top/bottom) explicitly when describing shapes\n- Example: \"The top ellipse at y=180\" or \"The bottom ellipse at y=248\"\n\nHIERARCHY AWARENESS:\n- The structure preserves the tree-like hierarchy of the design (groups, frames, containers)\n- Shapes may be nested within groups or other containers\n- Use the 'relativeBounds' coordinates (not 'bounds') when describing positions - these are relative to the parent container (group/frame)\n- The frame's top-left corner is at (0, 0)\n- Shapes within groups have coordinates relative to their group, not the frame\n\nFor each shape, mention:\n- Exact pixel positions using relativeBounds (x, y coordinates relative to parent container) - remember these are TOP-LEFT corner coordinates\n- Visual position (top/bottom/left/right) to clarify despite the flipped y-axis\n- Center coordinates from relativeBounds (centerX, centerY relative to parent)\n- Dimensions (width x height in pixels)\n- Which group or container it belongs to (if nested)\n- Spatial relationships between shapes with specific pixel distances and visual directions\n- Frame dimensions and how shapes are positioned within the frame\n\nUse specific numbers from the relativeBounds data. Keep it to 4-5 sentences:\n\n{domRepresentation}",
    "screenshotInterpretationPrompt": "You have also been provided with a screenshot of the frame. Please interpret this screenshot and interpolate between the visual geometries you see in the screenshot and the exact values provided in the DOM representation above. Use the screenshot to understand the visual appearance, spatial relationships, and design intent, while using the DOM representation for precise numerical values, coordinates, and structural information. Combine both sources of information to provide an accurate and comprehensive description.",
    "completionPrompt": "Given the existing shape description and the user's request to \"{userPrompt}\", generate instructions for creating additional shapes.\n\nSPATIAL CONTEXT & HIERARCHY:\n- The existing shape description is: {vectorDescription}\n- The DOM representation preserves the hierarchical tree structure (groups, frames, containers)\n- IMPORTANT: Respect the existing hierarchy when positioning new shapes\n- Shapes may be nested within groups - if you're adding shapes that relate to grouped shapes, consider placing them in the same group\n- Use the relativeBounds coordinates when positioning new shapes - these are relative to the parent container (group or frame)\n- The frame's top-left corner is at (0, 0) - coordinates at the frame level are relative to this\n- Shapes within groups have coordinates relative to their group's top-left corner\n- Frame dimensions are provided - ensure all new shapes are positioned within these bounds (0 to frame.width for x, 0 to frame.height for y)\n- Use the relativeBounds center coordinates (centerX, centerY) of existing shapes to position new shapes logically relative to them\n- The x, y coordinates you provide should be the top-left corner of the shape, using the same coordinate system as the target container (frame or group)\n- Position new shapes in a way that makes visual sense relative to existing shapes, respecting their hierarchical relationships\n- If shapes are grouped together, new related shapes should likely be placed in the same group or at the same hierarchy level\n\nDOM representation: {domRepresentation}\n\nCRITICAL JSON FORMAT REQUIREMENTS:\n- Respond with ONLY valid JSON - no comments, no explanations, no markdown code blocks\n- Do NOT include comments (// or /* */) in the JSON\n- Do NOT include arithmetic expressions (e.g., \"240.5 - 10\") - calculate the values yourself and use the final number\n- All numeric values must be actual numbers, not expressions\n- The response must be a valid JSON array that can be parsed directly\n\nRespond with a JSON array where each object has: type (circle, rectangle, ellipse, polygon, star, line, vector, or arrow), x, y, width, height (if applicable), pointCount (for polygon/star), innerRadius (for star), fills (color as RGB 0-1), strokes (color as RGB 0-1), strokeWeight, and any path data if it's a vector path. IMPORTANT: Use coordinates relative to the appropriate container (frame or group) - ensure x and y coordinates place shapes within the frame bounds (0 to frame width/height) and in logical positions relative to existing shapes, respecting the hierarchical structure.",
    "planningPrompt": "Given the existing shape description and the user's request to \"{userPrompt}\", create a detailed plan in plain English describing exactly what needs to be done.\n\nSPATIAL CONTEXT & HIERARCHY:\n- The existing shape description is: {vectorDescription}\n- The DOM representation preserves the hierarchical tree structure (groups, frames, containers)\n- IMPORTANT: Respect the existing hierarchy when planning modifications\n- Shapes may be nested within groups - consider the hierarchy when planning where to add or modify shapes\n- Use the relativeBounds coordinates when planning positions - these are relative to the parent container (group or frame)\n- The frame's top-left corner is at (0, 0)\n- Frame dimensions are provided - ensure all planned shapes are within these bounds\n- Remember: x, y coordinates represent the TOP-LEFT corner of objects, not the center\n- To center an object at (centerX, centerY), calculate: x = centerX - (width / 2), y = centerY - (height / 2)\n\nDOM representation: {domRepresentation}\n\nYour plan should:\n1. Clearly state whether each action is ADD (new shape) or MODIFY (existing shape)\n2. For ADD operations: Specify the exact type (circle, rectangle, ellipse, polygon, star, line, vector, arrow), position (x, y coordinates relative to parent container - these are TOP-LEFT corner coordinates), size (width, height in pixels), colors (fill RGB 0-1, stroke RGB 0-1), stroke weight, and any other geometric properties\n3. For MODIFY operations: Identify the shape to modify by BOTH visual description (e.g., \"the top pair of circles\", \"the bottom-left rectangle\") AND coordinates, then specify exactly what properties to change (position, size, color, stroke, etc.) with exact new values\n4. Include exact numerical values for all properties (no expressions, no ranges, no approximations)\n5. Specify which container (frame or group) each shape belongs to\n6. Describe spatial relationships with exact pixel distances and visual directions (top/bottom/left/right)\n7. Be specific about colors using RGB values (0-1 range)\n8. When identifying shapes, always clarify visual position (top/bottom) to avoid confusion with the flipped y-axis\n9. When positioning shapes, remember that coordinates are for the top-left corner - if you need to center something, calculate the top-left position from the desired center\n\nRespond with a clear, structured plan in plain English. Use exact numbers from the DOM representation. Organize the plan by operation type (ADD operations first, then MODIFY operations).",
    "executionPrompt": "Based on the following detailed plan, generate a JSON structure that specifies exactly which Figma primitives need to be added or modified.\n\nPLAN:\n{plan}\n\nEXISTING DOM REPRESENTATION:\n{domRepresentation}\n\nJSON FORMAT REQUIREMENTS:\n- Respond with ONLY valid JSON - no comments, no explanations, no markdown code blocks\n- Do NOT include comments (// or /* */) in the JSON\n- Do NOT include arithmetic expressions - use calculated numbers only\n- All numeric values must be actual numbers, not expressions\n- The response must be a valid JSON object with an \"operations\" array\n\nJSON STRUCTURE:\n{\n  \"operations\": [\n    {\n      \"action\": \"add\" | \"modify\",\n      \"type\": \"circle\" | \"rectangle\" | \"ellipse\" | \"polygon\" | \"star\" | \"line\" | \"vector\" | \"arrow\" (required for add, optional for modify),\n      \"targetId\": \"string\" (required for modify - reference to existing shape),\n      \"targetDescription\": \"string\" (alternative for modify - description to identify shape),\n      \"x\": number (top-left x coordinate relative to parent container),\n      \"y\": number (top-left y coordinate relative to parent container),\n      \"width\": number (if applicable),\n      \"height\": number (if applicable),\n      \"radius\": number (for circles),\n      \"pointCount\": number (for polygon/star),\n      \"innerRadius\": number (for star),\n      \"fills\": [{ \"type\": \"SOLID\", \"color\": { \"r\": number, \"g\": number, \"b\": number }, \"opacity\": number }],\n      \"strokes\": [{ \"type\": \"SOLID\", \"color\": { \"r\": number, \"g\": number, \"b\": number }, \"opacity\": number }],\n      \"strokeWeight\": number,\n      \"data\": \"string\" (for vector paths),\n      \"cornerRadius\": number (for rectangles),\n      \"parentContainer\": \"frame\" | \"group\" (optional, defaults to frame)\n    }\n  ]\n}\n\nFor MODIFY operations, only include the properties that should be changed. Omit properties that should remain unchanged.\n\nIMPORTANT: Use the exact numerical values from the plan. All coordinates are relative to the parent container (frame or group)."
}