<!DOCTYPE html>
<html>

<head>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #FFF9F0;
            padding: 24px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            overflow-y: auto;
        }

        .logo-container {
            margin-bottom: 24px;
        }

        .logo {
            width: 80px;
            height: 80px;
            display: block;
        }

        h1 {
            font-size: 18px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 8px;
            text-align: center;
        }

        .subtitle {
            font-size: 12px;
            color: #666;
            text-align: center;
            margin-bottom: 32px;
            line-height: 1.5;
            max-width: 280px;
        }

        .button-container {
            width: 100%;
            max-width: 280px;
        }

        button {
            width: 100%;
            padding: 14px 20px;
            background: #1a1a1a;
            color: #FFF9F0;
            border: none;
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 12px;
        }

        button:hover {
            background: #333;
            transform: translateY(-1px);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .stop-button {
            background: #d4380d;
        }

        .stop-button:hover {
            background: #ad2102;
        }

        .status {
            width: 100%;
            max-width: 280px;
            font-size: 11px;
            padding: 12px 16px;
            background: #fff;
            border-radius: 8px;
            margin-top: 8px;
            line-height: 1.5;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
            display: none;
        }

        .status.visible {
            display: block;
        }

        .status.processing {
            color: #1a1a1a;
            border-left: 3px solid #faad14;
        }

        .status.success {
            color: #237804;
            border-left: 3px solid #52c41a;
        }

        .status.error {
            color: #cf1322;
            border-left: 3px solid #f5222d;
        }

        .input-group {
            width: 100%;
            max-width: 280px;
            margin-bottom: 16px;
        }

        .input-label {
            font-size: 11px;
            font-weight: 500;
            color: #666;
            margin-bottom: 6px;
            display: block;
        }

        input[type="text"],
        input[type="number"],
        textarea {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 12px;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: #fff;
            color: #1a1a1a;
            transition: border-color 0.2s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        textarea:focus {
            outline: none;
            border-color: #1a1a1a;
        }

        input[type="password"] {
            font-family: monospace;
            font-size: 11px;
        }

        input[type="number"] {
            font-family: monospace;
        }

        .config-section {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid #eee;
            width: 100%;
            max-width: 280px;
        }

        .config-section-title {
            font-size: 12px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 16px;
            text-align: center;
        }

        .results-section {
            width: 100%;
            max-width: 600px;
            margin-top: 24px;
            padding: 16px;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06);
            display: none;
        }

        .results-section.visible {
            display: block;
        }

        .results-title {
            font-size: 14px;
            font-weight: 600;
            color: #1a1a1a;
            margin-bottom: 16px;
            text-align: center;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11px;
            margin-bottom: 16px;
        }

        .results-table th {
            background: #f8f9fa;
            padding: 8px;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 2px solid #e0e0e0;
            position: sticky;
            top: 0;
        }

        .results-table td {
            padding: 8px;
            border-bottom: 1px solid #f0f0f0;
        }

        .results-table tr:hover {
            background: #f8f9fa;
        }

        .results-table .version-col {
            font-weight: 600;
            color: #1a1a1a;
        }

        .results-table .time-col {
            font-family: monospace;
            text-align: right;
        }

        .results-table .success-col {
            text-align: center;
        }

        .summary-box {
            margin-top: 16px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border-left: 3px solid #1a1a1a;
        }

        .summary-title {
            font-size: 11px;
            font-weight: 600;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .summary-stats {
            font-size: 11px;
            color: #333;
            line-height: 1.8;
        }

        .summary-stats .stat-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px;
        }

        .summary-stats .stat-label {
            color: #666;
        }

        .summary-stats .stat-value {
            font-weight: 600;
            color: #1a1a1a;
            font-family: monospace;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            background: #1a1a1a;
            transition: width 0.3s ease;
            width: 0%;
        }

        .comparison-section {
            margin-top: 16px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .comparison-title {
            font-size: 11px;
            font-weight: 600;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 10px;
        }

        .comparison-table th {
            background: #fff;
            padding: 6px;
            text-align: left;
            font-weight: 600;
            color: #666;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table td {
            padding: 6px;
            border-bottom: 1px solid #f0f0f0;
            font-family: monospace;
        }

        .comparison-table .better {
            color: #237804;
            font-weight: 600;
        }

        .comparison-table .worse {
            color: #cf1322;
        }

        .scrollable {
            max-height: 400px;
            overflow-y: auto;
        }
    </style>
</head>

<body>
    <div class="logo-container">
        <svg id="Layer_3" data-name="Layer 3" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 465.99 637.66"
            class="logo">
            <defs>
                <style>
                    .cls-1 {
                        fill: #57b8c1;
                    }

                    .cls-2 {
                        fill: #f1e912;
                    }

                    .cls-3 {
                        fill: #fee600;
                    }

                    .cls-4 {
                        fill: #fff;
                    }

                    .cls-5 {
                        fill: #1f7741;
                    }

                    .cls-6 {
                        fill: #0a0c0b;
                    }
                </style>
            </defs>
            <path class="cls-2"
                d="M47.77,161.36s140.53-32.23,191.28-35.88c47.99-3.45,148.18,9.99,186.16,50.57,5.86,6.26,26.77-45,26.77-45l-106.06-47.66-26.74-68.92-58.63,26.74-57.65-23.13-42.02-.98-63.25,86.24-80.03-5.06,30.16,63.07Z" />
            <path class="cls-1"
                d="M320.63,443.31c43.39,0,15.15-293.91-121.36-329.75C-22.21,55.41-17.57,421.61,48.83,536.5c66.4,114.89,153.71,107.65,207.74,93.19,43.22-11.57-3.32-137.43-8.33-186.38-1.06-10.35,30.97,0,72.38,0Z" />
            <path class="cls-3"
                d="M266.58,50.99c-12.38,3.41-64.49-33.83-86.74-29.29-23.71,4.84-54.65,54.22-59.12,77.24,66.86,1.31,133.75-6.91,199.81-15.98,5.47-.75,13.97,1.03,13.95-5.37-.01-4.8-18.49-53.68-21.21-54.87-7.87-3.45-38.16,25.92-46.69,28.27Z" />
            <path class="cls-6"
                d="M270.57,564.48c-14.09,2.46-61.57,10.37-72.29,4.86-10.43-5.36-7.48-25.33-12.89-30.56-1.72-1.67-37.98-13.23-45.05-16.4-39.8-17.82-100.67-62.38-123.52-99.76-6.14-10.05-9.19-14.38-4-25.97,4.18-9.32,25.78-31.26,26.06-39.45.35-9.99-21.73-65.05-26.06-79.43C10.26,269.23-.71,235.89.04,229.59c.93-7.81,22.69-20.73,29.77-25.75,4.18-2.97,32.94-20.21,32.93-22.48-3.85-5.14-11.65-8.42-15.95-12.49-11.87-11.23-23.25-24.45-29.82-39.61-4.49-10.35-17.31-42.71,3.29-43.32l77.31,10.81C113.43,62.37,144.5-4.07,190.89,1.3c17.09,1.98,62.31,28.09,71.11,27.69,16.8-.78,44.21-47.3,65.93-20.86,10.26,12.48,25.75,70.67,28.96,72.94,2.34,1.65,24.04,2.91,29.76,4.21,19.59,4.44,43.09,19.62,58.22,32.7,7.39,6.39,23.79,18.37,18.97,28.9-4.82,10.52-41.97,38.25-43.43,46.56l38.73,119.6c-13.29,24.28-36.87,42.45-52.24,65.63l-17.21,152.62c-1.8,4.41-4.26,5.1-8.21,6.77-22.68,9.6-84.76,21.89-110.91,26.45ZM266.58,50.99c-12.38,3.41-64.49-33.83-86.74-29.29-23.71,4.84-54.65,54.22-59.12,77.24,66.86,1.31,133.75-6.91,199.81-15.98,5.47-.75,13.97,1.03,13.95-5.37-.01-4.8-18.49-53.68-21.21-54.87-7.87-3.45-38.16,25.92-46.69,28.27ZM247.6,111.92c-1.28-1.27-31.24,2.6-35.97,3-40.61,3.47-73.97,5.21-114.89,2-9.05-.71-62.65-10.33-64.93-7.99-6.19,6.34,20.85,37.09,25.97,41.95,3.54,3.37,20.83,18.55,24.48,18.58,7.77.08,41.1-27.79,53.47-26.18,4.18.54,65.52,39.36,71.62,44.34,10.02,8.18,15.39,23.6-1.51,20.54-14.89-2.7-63.85-43.08-74.52-42.28-6.61.5-48.98,27.13-57.47,32.54-6.3,4.01-49.31,32.27-50.51,35.41-1.95,5.11,26.69,102.19,31.5,104.81,1.25.68,2.45-.37,3.48-.89,16.33-8.19,50.32-56.46,69.43-67.43,4.68-2.68,13.53-3.1,14.78,3.17-.54,3.98-1.67,7.78-7.21,14.17-8.66,9.99-13.44,14.72-18.62,20.56-13.99,13.69-81.85,81.12-84.68,95.19-1.29,6.4,7.73,15.57,11.79,20.68,28.02,35.29,76.06,69.3,117.89,85.91,3.21,1.27,17.75,8.35,18.87,4.92l-40.88-168.22h19.98c7.64,33.86,17.55,67.27,25.97,100.9,6.47,25.8,10.98,52.2,17.98,77.92.97,3.56,4.89,22.09,5.92,23.3,2.71,3.19,40.35.81,42.45-1.19,1.24-1.18.49-15.9.58-19.11.77-26.89-5.16-32.23,12.99-53.95,2.03-2.43,15.72-12.71,13.57-16.03-1.59-2.44-27.98-8.43-32.55-9.95-15.65-5.17-43.12-7.38-26.48-28.98,1.95-2.53,23.32-21.97,24.98-21.97h39.96c2.36,0,1.55-21.01,1.53-23.51-.27-56.45-7.75-116.54-6.08-172.74.18-6.11.15-13.99,3.04-19.53,6.02-11.54,29.05-18.52,41.43-17.95,27.1,1.26,78.81,36.96,54.44,67.37-20.59,25.7-66.9,11.85-66.9-15.95v-28.47c-15.84,2.06-11.79,15.39-11.99,26.97-1.28,74.43,10.14,152.94,6.99,226.78-1.12,26.24-4.31,22.19-19.98,40.96-4.14,4.96-11.78,9.42-14.2,16.27-3.08,8.7-.96,13.65-.78,21.7.02,1-.04,2,0,3v17.98l98.68-22.22,17.49-147.84,48.75-62.22-39.84-119.61c.43-9.68,43.14-42.61,42.68-47.08-42.86-52.64-112.11-41.19-171.23-31.6-2.25,2.44-2.22,41.27-2.52,47.93-2.84,63.98-3.7,128.09-6.21,192.09-1.45,11.04-45.24,7.29-48.33,3.81-2.99-3.38-2.69-12.54,1.19-14.98,5.69-3.58,25.78,2.32,28.37-4.6-.75-59.98,6.86-122.13,6.05-181.77l-.04-40.52ZM335,185.88c-1.42.45-1.02,26.49-.51,29.47,3.02,17.76,30,10.19,31.58-.46,1.32-8.9-27.16-30.25-31.06-29.01ZM287.06,415.63h-31.97c-1.99,0-10.5,8.58-13.02,9.96l.57,2.5,46.4,11.54-1.98-24Z" />
            <path
                d="M147.82,199.3c-15.29.37-36.02,9.95-44.64,22.99-15.76,23.84,31.49,41.85,50.78,40.6,13.21-.85,35.56-11.56,43.03-22.67,14.71-21.89-30.8-41.36-49.17-40.92Z" />
            <path class="cls-5" d="M287.06,415.63h-31.97c-1.99,0-10.5,8.58-13.02,9.96l.57,2.5,46.4,11.54-1.98-24Z" />
            <path class="cls-4"
                d="M159.14,211.08c-7.12-.71-11.5,2.51-16.25,8.06-8.68,10.15,6.42,21.27,15.44,21.8,6.18.36,17.17-3.32,21.27-8.04,8.08-9.31-11.92-20.96-20.46-21.82Z" />
        </svg>
    </div>

    <h1>Picasso Benchmark</h1>
    <p class="subtitle">Test and compare execution performance</p>

    <div class="input-group">
        <label class="input-label" for="api-key">OpenAI API Key</label>
        <input type="password" id="api-key" placeholder="sk-..." />
    </div>

    <div class="config-section">
        <div class="config-section-title">Benchmark Configuration</div>
        <div class="input-group">
            <label class="input-label" for="iterations">Iterations per Test</label>
            <input type="number" id="iterations" value="3" min="1" max="10" />
        </div>
    </div>

    <div class="button-container">
        <button id="run-benchmark">Run Benchmark</button>
        <button id="stop-benchmark" class="stop-button" style="display: none;">Stop Benchmark</button>
    </div>

    <div id="status" class="status"></div>
    <div class="progress-bar" id="progress-bar" style="display: none;">
        <div class="progress-fill" id="progress-fill"></div>
    </div>

    <div id="results" class="results-section">
        <div class="results-title">Benchmark Results</div>
        <div class="scrollable">
            <table class="results-table" id="results-table">
                <thead>
                    <tr>
                        <th>Version</th>
                        <th>Test Case</th>
                        <th>Type</th>
                        <th>Avg (ms)</th>
                        <th>Min (ms)</th>
                        <th>Max (ms)</th>
                        <th>API Calls</th>
                        <th>Success</th>
                    </tr>
                </thead>
                <tbody id="results-tbody">
                </tbody>
            </table>
        </div>
        <div class="summary-box" id="summary-box">
            <div class="summary-title">Summary Statistics</div>
            <div class="summary-stats" id="summary-stats">
            </div>
        </div>
        <div class="comparison-section" id="comparison-section" style="display: none;">
            <div class="comparison-title">Version Comparison</div>
            <div class="scrollable">
                <table class="comparison-table" id="comparison-table">
                    <thead>
                        <tr>
                            <th>Metric</th>
                        </tr>
                    </thead>
                    <tbody id="comparison-tbody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let isRunning = false;
        let apiKey = '';
        let currentBenchmarkId = null;

        // Request saved API key from plugin on load
        parent.postMessage({ pluginMessage: { type: 'get-api-key' } }, '*');

        // Save API key when changed
        document.getElementById('api-key').addEventListener('input', (e) => {
            apiKey = e.target.value;
            if (apiKey) {
                parent.postMessage({
                    pluginMessage: {
                        type: 'save-api-key',
                        apiKey: apiKey
                    }
                }, '*');
            }
        });

        document.getElementById('api-key').addEventListener('blur', (e) => {
            if (apiKey) {
                parent.postMessage({
                    pluginMessage: {
                        type: 'save-api-key',
                        apiKey: apiKey
                    }
                }, '*');
            }
        });

        document.getElementById('run-benchmark').onclick = () => {
            if (!apiKey) {
                alert('Please enter your OpenAI API key first');
                return;
            }
            const iterations = parseInt(document.getElementById('iterations').value) || 3;
            parent.postMessage({
                pluginMessage: {
                    type: 'run-benchmark',
                    apiKey: apiKey,
                    iterations: iterations
                }
            }, '*');
        };

        document.getElementById('stop-benchmark').onclick = () => {
            if (currentBenchmarkId) {
                parent.postMessage({
                    pluginMessage: {
                        type: 'stop-benchmark',
                        benchmarkId: currentBenchmarkId
                    }
                }, '*');
            }
        };

        function updateButtons() {
            const runButton = document.getElementById('run-benchmark');
            const stopButton = document.getElementById('stop-benchmark');

            if (isRunning) {
                runButton.style.display = 'none';
                stopButton.style.display = 'block';
                runButton.disabled = true;
            } else {
                runButton.style.display = 'block';
                stopButton.style.display = 'none';
                runButton.disabled = false;
            }
        }

        function updateProgress(current, total) {
            const progressBar = document.getElementById('progress-bar');
            const progressFill = document.getElementById('progress-fill');
            const percentage = total > 0 ? (current / total) * 100 : 0;
            progressFill.style.width = percentage + '%';
            progressBar.style.display = 'block';
        }

        function displayResults(results) {
            const resultsSection = document.getElementById('results');
            const tbody = document.getElementById('results-tbody');
            const summaryStats = document.getElementById('summary-stats');
            const comparisonSection = document.getElementById('comparison-section');

            resultsSection.className = 'results-section visible';
            tbody.innerHTML = '';

            // Group results by version and test case
            const grouped = new Map();
            for (const result of results) {
                const key = `${result.version}::${result.testCase}`;
                if (!grouped.has(key)) {
                    grouped.set(key, []);
                }
                grouped.get(key).push(result);
            }

            // Calculate statistics and display
            const stats = [];
            for (const [key, groupResults] of grouped) {
                const [version, testCase] = key.split('::');
                const times = groupResults.map(r => r.totalTimeMs);
                const avgTime = times.reduce((a, b) => a + b, 0) / times.length;
                const minTime = Math.min(...times);
                const maxTime = Math.max(...times);
                const avgApiCalls = groupResults.reduce((sum, r) => sum + r.apiCallCount, 0) / groupResults.length;
                const successCount = groupResults.filter(r => r.success).length;
                const successRate = (successCount / groupResults.length) * 100;

                stats.push({
                    version,
                    testCase,
                    inputType: groupResults[0].inputType,
                    avgTime,
                    minTime,
                    maxTime,
                    avgApiCalls,
                    successRate,
                    iterations: groupResults.length
                });

                // Add row to table
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td class="version-col">${version}</td>
                    <td>${testCase}</td>
                    <td>${groupResults[0].inputType}</td>
                    <td class="time-col">${avgTime.toFixed(2)}</td>
                    <td class="time-col">${minTime.toFixed(2)}</td>
                    <td class="time-col">${maxTime.toFixed(2)}</td>
                    <td class="time-col">${avgApiCalls.toFixed(1)}</td>
                    <td class="success-col">${successRate.toFixed(1)}%</td>
                `;
                tbody.appendChild(row);
            }

            // Display summary statistics
            const totalResults = results.length;
            const totalVersions = new Set(results.map(r => r.version)).size;
            const totalTestCases = new Set(results.map(r => r.testCase)).size;
            const overallAvgTime = results.reduce((sum, r) => sum + r.totalTimeMs, 0) / totalResults;
            const overallSuccessRate = (results.filter(r => r.success).length / totalResults) * 100;

            summaryStats.innerHTML = `
                <div class="stat-item">
                    <span class="stat-label">Total Results:</span>
                    <span class="stat-value">${totalResults}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Versions Tested:</span>
                    <span class="stat-value">${totalVersions}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Test Cases:</span>
                    <span class="stat-value">${totalTestCases}</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Overall Avg Time:</span>
                    <span class="stat-value">${overallAvgTime.toFixed(2)}ms</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Overall Success Rate:</span>
                    <span class="stat-value">${overallSuccessRate.toFixed(1)}%</span>
                </div>
            `;

            // Display comparison if multiple versions
            if (totalVersions > 1) {
                comparisonSection.style.display = 'block';
                displayComparison(stats);
            } else {
                comparisonSection.style.display = 'none';
            }
        }

        function displayComparison(stats) {
            const comparisonTbody = document.getElementById('comparison-tbody');
            const comparisonThead = document.querySelector('#comparison-table thead tr');

            // Get unique versions and test cases
            const versions = [...new Set(stats.map(s => s.version))].sort();
            const testCases = [...new Set(stats.map(s => s.testCase))].sort();

            // Build header with versions
            comparisonThead.innerHTML = '<th>Metric</th>' + versions.map(v => `<th>${v}</th>`).join('');

            comparisonTbody.innerHTML = '';

            // For each test case, show comparison
            for (const testCase of testCases) {
                const testCaseStats = stats.filter(s => s.testCase === testCase);
                if (testCaseStats.length === 0) continue;

                // Average time comparison
                const avgTimeRow = document.createElement('tr');
                const avgTimes = versions.map(v => {
                    const stat = testCaseStats.find(s => s.version === v);
                    return stat ? stat.avgTime : null;
                });
                const bestAvgTime = Math.min(...avgTimes.filter(t => t !== null));
                avgTimeRow.innerHTML = `
                    <td><strong>${testCase} - Avg Time (ms)</strong></td>
                    ${avgTimes.map((time, i) => {
                    if (time === null) return '<td>-</td>';
                    const isBest = time === bestAvgTime;
                    return `<td class="${isBest ? 'better' : ''}">${time.toFixed(2)}</td>`;
                }).join('')}
                `;
                comparisonTbody.appendChild(avgTimeRow);

                // Success rate comparison
                const successRow = document.createElement('tr');
                const successRates = versions.map(v => {
                    const stat = testCaseStats.find(s => s.version === v);
                    return stat ? stat.successRate : null;
                });
                const bestSuccessRate = Math.max(...successRates.filter(r => r !== null));
                successRow.innerHTML = `
                    <td><strong>${testCase} - Success Rate (%)</strong></td>
                    ${successRates.map((rate, i) => {
                    if (rate === null) return '<td>-</td>';
                    const isBest = rate === bestSuccessRate;
                    return `<td class="${isBest ? 'better' : ''}">${rate.toFixed(1)}%</td>`;
                }).join('')}
                `;
                comparisonTbody.appendChild(successRow);
            }
        }

        window.onmessage = (event) => {
            const msg = event.data.pluginMessage;
            const statusEl = document.getElementById('status');

            if (msg.type === 'benchmark-started') {
                isRunning = true;
                currentBenchmarkId = msg.benchmarkId;
                updateButtons();
                statusEl.className = 'status visible processing';
                statusEl.textContent = 'üöÄ Benchmark started...';
                document.getElementById('results').className = 'results-section';
            } else if (msg.type === 'benchmark-progress') {
                statusEl.className = 'status visible processing';
                statusEl.textContent = msg.message;
                if (msg.current !== undefined && msg.total !== undefined) {
                    updateProgress(msg.current, msg.total);
                }
            } else if (msg.type === 'benchmark-complete') {
                isRunning = false;
                currentBenchmarkId = null;
                updateButtons();
                statusEl.className = 'status visible success';
                statusEl.textContent = '‚úÖ Benchmark complete!';
                document.getElementById('progress-bar').style.display = 'none';
                if (msg.results) {
                    displayResults(msg.results);
                }
            } else if (msg.type === 'benchmark-stopped') {
                isRunning = false;
                currentBenchmarkId = null;
                updateButtons();
                statusEl.className = 'status visible';
                statusEl.textContent = 'Benchmark stopped.';
                document.getElementById('progress-bar').style.display = 'none';
            } else if (msg.type === 'benchmark-error') {
                isRunning = false;
                currentBenchmarkId = null;
                updateButtons();
                statusEl.className = 'status visible error';
                statusEl.textContent = '‚ö†Ô∏è ' + msg.message;
                document.getElementById('progress-bar').style.display = 'none';
            } else if (msg.type === 'api-key-loaded') {
                if (msg.apiKey) {
                    document.getElementById('api-key').value = msg.apiKey;
                    apiKey = msg.apiKey;
                }
            }
        };

        updateButtons();
    </script>
</body>

</html>